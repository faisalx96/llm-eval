<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LLM Eval UI</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <div class="container">
    <header class="header" role="banner">
      <div class="header-row">
        <h1>LLM Evaluation Results</h1>
        <div class="header-tools" role="group" aria-label="Actions">
          <button id="export-btn" class="btn" title="Export current view to CSV">Export CSV</button>
        </div>
      </div>
      <div id="run-meta" class="sub"></div>
      <div id="stats" class="stats-grid"></div>
      <div id="quickbar" class="quickbar" aria-label="Latency and error summary"></div>
    </header>
    <h2 class="section-title" id="overview-title">Overview</h2>
    <section class="panels" aria-labelledby="overview-title">
      <div class="panel">
        <h3>Latency</h3>
        <div class="kv"><span>Mean</span><strong id="lat-mean">—</strong></div>
        <div class="kv"><span>P50</span><strong id="lat-p50">—</strong></div>
        <div class="kv"><span>P90</span><strong id="lat-p90">—</strong></div>
        <div class="kv"><span>P99</span><strong id="lat-p99">—</strong></div>
      </div>
      <div class="panel">
        <h3>Errors</h3>
        <div class="kv"><span>Timeout</span><strong id="err-timeout">0</strong></div>
        <div class="kv"><span>Runtime</span><strong id="err-runtime">0</strong></div>
        <div class="kv"><span>Unknown</span><strong id="err-unknown">0</strong></div>
        <div class="kv"><span>Metric</span><strong id="err-metric">0</strong></div>
      </div>
    </section>
    <h2 class="section-title" id="results-title">Results</h2>
    <div class="controls" id="toolbar" role="region" aria-label="Filters and search">
        <span class="control-group">
          <label for="q">Search</label>
          <input id="q" type="search" placeholder="Input / Output / Expected" title="Search input, output, or expected" />
        </span>
        <span class="control-group">
          <label for="status">Status</label>
          <select id="status" class="sr-only" aria-hidden="true" tabindex="-1" title="Filter by status (hidden native)">
            <option value="all" selected>All</option>
            <option value="completed">Completed</option>
            <option value="in_progress">In Progress</option>
            <option value="error">Failed</option>
            <option value="pending">Pending</option>
          </select>
          <div class="dropdown" id="status-dropdown">
            <button class="dropdown-toggle" id="status-menu-btn" aria-expanded="false" aria-haspopup="true" title="Filter by status">Status: All ▾</button>
            <div class="dropdown-menu" id="status-menu" role="menu" aria-label="Status"></div>
          </div>
        </span>
        <span class="control-group">
          <label>Columns</label>
          <div class="dropdown" id="col-dropdown">
            <button class="dropdown-toggle" id="col-menu-btn" aria-expanded="false" aria-haspopup="true" title="Show/Hide columns">Columns ▾</button>
            <div class="dropdown-menu" id="col-menu" role="menu" aria-label="Columns"></div>
            <div class="dropdown-menu" id="col-menu-footer" role="menu" aria-label="Columns actions" style="display:none;"></div>
          </div>
        </span>
        <span class="control-group">
          <label for="page-size">Rows</label>
          <select id="page-size" class="sr-only" aria-hidden="true" tabindex="-1" title="Rows per page (hidden native)">
            <option>25</option>
            <option selected>50</option>
            <option>100</option>
            <option>200</option>
          </select>
          <div class="dropdown" id="rows-dropdown">
            <button class="dropdown-toggle" id="rows-menu-btn" aria-expanded="false" aria-haspopup="true" title="Rows per page">Rows: 50 ▾</button>
            <div class="dropdown-menu" id="rows-menu" role="menu" aria-label="Rows per page"></div>
          </div>
        </span>
      </div>
    <section class="table-wrap" aria-labelledby="results-title">
      
      <table role="table" aria-describedby="results-title">
        <caption class="sr-only">Evaluation Results</caption>
        <thead id="thead"></thead>
        <tbody id="rows"></tbody>
      </table>
      <div class="empty-state" id="empty-state" style="display:none;">No results match your filters.</div>
      <div class="pager" role="navigation" aria-label="Pagination">
        <button id="prev">Prev</button>
        <span id="pageinfo"></span>
        <button id="next">Next</button>
      </div>
    </section>

    <!-- Row details drawer -->
    <div id="drawer-overlay" class="drawer-overlay" hidden>
      <div class="drawer" role="dialog" aria-modal="true">
        <div class="drawer-header">
          <div id="drawer-title">Row Details</div>
          <div style="display:flex; gap:8px; align-items:center;">
            <a id="drawer-open-langfuse" class="btn" href="#" target="_blank" rel="noopener" style="display:none;">Open in Langfuse ↗</a>
            <button id="drawer-close" aria-label="Close">✕</button>
          </div>
        </div>
        <div class="drawer-controls">
          <label><input type="checkbox" id="diff-toggle" /> Show Diff (Output vs Expected)</label>
        </div>
        <div class="drawer-section">
          <div class="label">Input <button class="copy-btn" id="copy-input" title="Copy input">⧉</button></div>
          <pre id="drawer-input" class="pre"></pre>
        </div>
        <div class="drawer-section">
          <div class="label">Output <button class="copy-btn" id="copy-output" title="Copy output">⧉</button></div>
          <pre id="drawer-output" class="pre"></pre>
        </div>
        <div class="drawer-section">
          <div class="label">Expected <button class="copy-btn" id="copy-expected" title="Copy expected">⧉</button></div>
          <pre id="drawer-expected" class="pre"></pre>
        </div>
        <div class="drawer-section">
          <div class="label">Trace <button class="copy-btn" id="copy-trace" title="Copy trace">⧉</button></div>
          <div id="drawer-trace" class="pre"></div>
        </div>
        <div class="drawer-section">
          <div class="label">Time</div>
          <div id="drawer-time" class="pre"></div>
        </div>
        <div class="drawer-section">
          <div class="label">Metrics</div>
          <div id="drawer-metrics" class="metrics-list"></div>
        </div>
      </div>
    </div>
  </div>
  <script src="app.js"></script>
</body>
  
</html>
